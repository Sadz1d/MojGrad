<div class="list-container">
  <!-- Pozadinska slika sa overlay-em -->
  <div class="list-overlay"></div>
  
  <div class="list-content">
    <!-- Logo & Brand -->
    <div class="list-brand">
      <div class="brand-logo-container">
        <img src="/assets/images/logo1.png" alt="Moj Grad Logo" class="brand-logo">
      </div>
      <h1 class="brand-name">Moj Grad</h1>
      <p class="brand-tagline">Upravljajte prijavama problema u va≈°em gradu</p>
    </div>

    <!-- Header Section -->
    <div class="list-header">
      <div class="title-badge">UPRAVLJANJE PRIJAVAMA</div>
      <h2 class="section-title">Prijavljeni problemi u gradu</h2>
      <p class="section-subtitle">
        Pregledajte, filtrirajte i upravljajte svim prijavljenim problemima
      </p>
    </div>

    <!-- Filter Card -->
    <div class="filter-section">
      <div class="filter-card">
        <div class="filter-header">
          <mat-icon>filter_list</mat-icon>
          <h3>Filter prijava</h3>
        </div>
        
        <form [formGroup]="filterForm" (ngSubmit)="applyFilter()" class="filter-form">
          <div class="filter-grid">
            <!-- Search -->
            <div class="filter-group">
              <label for="search" class="filter-label">
                <mat-icon>search</mat-icon>
                Pretraga (naslov/opis)
              </label>
              <input type="text" id="search" class="filter-input" formControlName="search" 
                     placeholder="Unesite tekst za pretragu...">
            </div>
            
            <!-- User ID -->
            <div class="filter-group">
              <label for="userId" class="filter-label">
                <mat-icon>person</mat-icon>
                ID korisnika
              </label>
              <input type="number" id="userId" class="filter-input" formControlName="userId" 
                     placeholder="ID autora" min="1">
            </div>
            
            <!-- Category ID -->
            <div class="filter-group">
              <label for="categoryId" class="filter-label">
                <mat-icon>category</mat-icon>
                ID kategorije
              </label>
              <input type="number" id="categoryId" class="filter-input" formControlName="categoryId" 
                     placeholder="ID kategorije" min="1">
            </div>
            
            <!-- Status ID -->
            <div class="filter-group">
              <label for="statusId" class="filter-label">
                <mat-icon>flag</mat-icon>
                ID statusa
              </label>
              <input type="number" id="statusId" class="filter-input" formControlName="statusId" 
                     placeholder="ID statusa" min="1">
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="filter-actions">
            <button type="submit" class="action-button action-primary" [disabled]="loading">
              <mat-icon *ngIf="!loading">filter_alt</mat-icon>
              <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
              {{ loading ? 'Primjenjujem...' : 'Primjeni filtere' }}
            </button>
            
            <button type="button" class="action-button action-secondary" (click)="resetFilter()">
              <mat-icon>restart_alt</mat-icon>
              Resetuj filtere
            </button>
            
            <button type="button" class="action-button action-success" 
                    [routerLink]="['/problem-reports/new']">
              <mat-icon>add_circle</mat-icon>
              + Nova prijava
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-section">
      <div class="loading-spinner"></div>
      <p>Uƒçitavanje podataka...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-section">
      <mat-icon>error_outline</mat-icon>
      <h4>Gre≈°ka pri uƒçitavanju</h4>
      <p>{{ error }}</p>
      <button class="action-button action-secondary" (click)="loadReports()">
        <mat-icon>refresh</mat-icon>
        Poku≈°aj ponovo
      </button>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && reports.length === 0 && !error" class="empty-section">
      <div class="empty-icon">üìã</div>
      <h3>Nema pronaƒëenih prijava</h3>
      <p>Poku≈°ajte da promjenite filtere ili kreirajte novu prijavu.</p>
      <button class="action-button action-success" 
              [routerLink]="['/problem-reports/new']">
        <mat-icon>add_circle</mat-icon>
        + Kreiraj prvu prijavu
      </button>
    </div>

    <!-- Data Table -->
    <div *ngIf="!loading && reports.length > 0" class="data-section">
      <div class="table-card">
        <div class="table-header">
          <div class="table-info">
            <mat-icon>table_chart</mat-icon>
            <span>Prikazano {{ reports.length }} prijava</span>
          </div>
          <div class="table-actions">
            <!-- Export dropdown menu -->
            <div class="export-dropdown" *ngIf="reports.length > 0">
              <button class="action-button action-secondary btn-sm" 
                      [matMenuTriggerFor]="exportMenu"
                      [disabled]="exporting">
                <mat-icon *ngIf="!exporting">download</mat-icon>
                <mat-spinner *ngIf="exporting" diameter="16"></mat-spinner>
                {{ exporting ? 'Exportuje se...' : 'Izvezi' }}
              </button>

              <button class="action-button action-success btn-sm" 
                      [routerLink]="['/problem-reports/import']">
                <mat-icon>upload</mat-icon>
                Uvezi
              </button>
              
              <mat-menu #exportMenu="matMenu">
                <button mat-menu-item (click)="exportData()">
                  <mat-icon>get_app</mat-icon>
                  <span>Trenutni prikaz ({{ reports.length }})</span>
                </button>
                <button mat-menu-item (click)="exportAllData()">
                  <mat-icon>archive</mat-icon>
                  <span>Svi podaci (sa filterima)</span>
                </button>
                <button mat-menu-item (click)="exportToCSV()">
                  <mat-icon>insert_drive_file</mat-icon>
                  <span>CSV format</span>
                </button>
                <button mat-menu-item (click)="exportAdvancedReport()">
                  <mat-icon>assessment</mat-icon>
                  <span>Advanced report</span>
                </button>
                <mat-divider></mat-divider>
                <button mat-menu-item disabled>
                  <mat-icon>info</mat-icon>
                  <span>Posljednji export: {{ getCurrentDate() }}</span>
                </button>
              </mat-menu>
            </div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Naslov</th>
                <th>Autor</th>
                <th>Kategorija</th>
                <th>Status</th>
                <th>Lokacija</th>
                <th>Datum</th>
                <th>Komentari</th>
                <th>Akcije</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let report of reports" class="table-row">
                <td class="report-id">
                  <span class="id-badge">#{{ report.id }}</span>
                </td>
                <td class="report-title">
                  <h4>{{ report.title }}</h4>
                  <p class="report-desc">{{ report.shortDescription }}</p>
                </td>
                <td class="report-author">
                  <div class="author-info">
                    <mat-icon class="author-icon">person</mat-icon>
                    <span>{{ report.authorName }}</span>
                  </div>
                </td>
                <td class="report-category">
                  <span class="category-badge">{{ report.categoryName }}</span>
                </td>
                <td class="report-status">
                  <span class="status-badge" [ngClass]="getStatusClass(report.statusName)">
                    {{ report.statusName }}
                  </span>
                </td>
                <td class="report-location">
                  <div class="location-info">
                    <mat-icon class="location-icon">location_on</mat-icon>
                    <span>{{ report.location || 'N/A' }}</span>
                  </div>
                </td>
                <td class="report-date">
                  <div class="date-info">
                    <mat-icon class="date-icon">calendar_today</mat-icon>
                    <span>{{ report.creationDate | date:'dd.MM.yyyy.' }}</span>
                  </div>
                </td>
                <td class="report-comments">
                  <div class="comments-info">
                    <mat-icon class="comments-icon">comment</mat-icon>
                    <span class="comments-count">{{ report.commentsCount }}</span>
                  </div>
                </td>
                <td class="report-actions">
                  <div class="action-buttons">
                    <button class="action-btn view-btn" (click)="viewReport(report.id)" matTooltip="Pregled">
                      <mat-icon>visibility</mat-icon>
                    </button>
                    <button class="action-btn edit-btn" (click)="editReport(report.id)" matTooltip="Izmjeni">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button class="action-btn delete-btn" (click)="deleteReport(report.id)" matTooltip="Obri≈°i">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="pagination-section" *ngIf="totalPages > 1">
          <div class="pagination-info">
            <span>Stranica {{ currentPage }} od {{ totalPages }} ‚Ä¢ Ukupno {{ totalItems }} prijava</span>
          </div>
          <div class="pagination-controls">
            <button class="pagination-btn" 
                    (click)="onPageChange(currentPage - 1)"
                    [disabled]="currentPage === 1">
              <mat-icon>chevron_left</mat-icon>
              Prethodna
            </button>
            
            <div class="page-numbers">
              <button *ngFor="let page of getPageNumbers()" 
                      class="page-number"
                      [class.active]="currentPage === page"
                      (click)="onPageChange(page)">
                {{ page }}
              </button>
            </div>
            
            <button class="pagination-btn" 
                    (click)="onPageChange(currentPage + 1)"
                    [disabled]="currentPage === totalPages">
              Sljedeƒáa
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="list-footer">
      
      <p class="platform-description">
        Prijavite problem, pomozite svojim sugraƒëanima<br>
        unaprijedite na≈° grad.
      </p>
    </div>
  </div>

  <!-- FLOATING HOME BUTTON - DODANO OVDJE -->
  <div class="floating-home-button">
    <button class="home-button" [routerLink]="['/']" matTooltip="Nazad na poƒçetnu" matTooltipPosition="left">
      <mat-icon>home</mat-icon>
      <span class="button-text">Poƒçetna</span>
    </button>
  </div>
</div>